<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Memory game</title>
</head>
<body>
    <div class="game-container">
<script>
        function Game(selector) {
            this.container = document.querySelector('body')
            this.gameBoard = null
            this.scoreContainer = null
            this.makeGameBoard = this.makeGameBoard.bind(this);
            this.createCard = this.createCard.bind(this);
            this.makeCardActive = this.makeCardActive.bind(this);
            this.makeCardInactive = this.makeCardInactive.bind(this);
            this.deckOfCards = [
                {
                    front: "A",
                    visible: false,
                    complete: false
                  },
                  {
                    front: "A",
                    visible: false,
                    complete: false
                  },
                  {
                    front: "B",
                    visible: false,
                    complete: false
                  },
                  {
                    front: "B",
                    visible: false,
                    complete: false
                  },
                  {
                    front: "C",
                    visible: false,
                    complete: false
                  },
                  {
                    front: "C",
                    visible: false,
                    complete: false
                  },
                  {
                    front: "D",
                    visible: false,
                    complete: false
                  },
                  {
                    front: "D",
                    visible: false,
                    complete: false
                  },
                  {
                    front: "E",
                    visible: false,
                    complete: false
                  },
                  {
                    front: "E",
                    visible: false,
                    complete: false
                  },
                  {
                    front: "F",
                    visible: false,
                    complete: false
                  },
                  {
                    front: "F",
                    visible: false,
                    complete: false
                  },
                  {
                    front: "G",
                    visible: false,
                    complete: false
                  },
                  {
                    front: "G",
                    visible: false,
                    complete: false
                  },
                  {
                    front: "H",
                    visible: false,
                    complete: false
                  },
                  {
                    front: "H",
                    visible: false,
                    complete: false
                  }
                ]
        }

        Game.prototype.colors = {
          cardBg: 'green',
          inactiveCardBg: 'black'
        };
        Game.prototype.init = init;
        Game.prototype.makeGameBoard = makeGameBoard;
        Game.prototype.setupBoard = setupBoard;
        Game.prototype.createCard = createCard;
        Game.prototype.makeCardActive = makeCardActive;
        Game.prototype.makeCardInactive = makeCardInactive;
        Game.prototype.render = render;

        function init(){
            this.makeGameBoard()
            this.render()
        }

        function makeGameBoard() {
          this.setupBoard();
          const gameBoard = document.querySelector('.game-board');
          this.deckOfCards.forEach((element, index) => {
            const card = this.createCard(index);
            gameBoard.appendChild(card)
            const cardRef = document.querySelector('.card-'+index);

            const cardClick = () => {
                if (newGame.deckOfCards[index].visible===true) {
                  this.makeCardInactive(cardRef, index)
                }
                else {
                  this.makeCardActive(cardRef, card, index)
                  for (let i=0; i<newGame.deckOfCards.length; i++){
                        if(newGame.deckOfCards[i].visible===true && i!==index){
                            newGame.deckOfCards[i].complete=true
                            newGame.deckOfCards[index].complete=true
                            console.log(newGame.deckOfCards[i])
                            console.log(newGame.deckOfCards[index])
                        }
                    }       
                }
            }

            cardRef.addEventListener('click', cardClick);
        })
        }

        function makeCardInactive(cardRef, index) {
          newGame.deckOfCards[index].visible = false
          cardRef.style.backgroundColor = this.colors.inactiveCardBg
          cardRef.innerHTML = ''
        }

        function makeCardActive(cardRef, card, index) {
          newGame.deckOfCards[index].visible = true
          cardRef.style.backgroundColor = this.colors.cardBg
          card.innerHTML = newGame.deckOfCards[index].front
        }

        function setupBoard() {
            const board = document.createElement('div')
            board.style.width='70vh'
            board.style.height='70vh'
            board.style.backgroundColor='yellow'
            board.style.display='flex'
            board.style.flexWrap='wrap'
            board.style.justifyContent='center'
            board.className='game-board'
          
            this.container.appendChild(board)
            this.gameBoard = board
        }

        function createCard(index) {
            const card = document.createElement('div')        
            card.style.width='15vh'
            card.style.height='15vh'
            card.style.display='flex'
            card.style.backgroundColor=this.colors.cardBg
            card.style.margin='1vh 1vh 1vh 1vh'
            card.style.justifyContent='center'
            card.style.alignItems='center'
            card.className='card-'+index
            card.innerHTML= newGame.deckOfCards[index].front
            return card;
        }

        function render(){
            this.deckOfCards.forEach((element, index, array) => {
                if(newGame.deckOfCards[index].visible===false){
                    document.querySelector('.card-'+index).style.backgroundColor = this.colors.inactiveCardBg
                    document.querySelector('.card-'+index).innerHTML = ''
                }
            })
        }
        let newGame = new Game
        newGame.init(document.querySelector('body'))
        </script>
    </div>
    <!-- <script src="game.js"></script> -->
</body>
</html>